{% extends "admin_layout.html" %}

{% block title %}Manage Members - Admin{% endblock %}

{% block admin_content %}
<!-- 
  This content will be injected into the 'admin_content' block
  in admin_layout.html.
-->
<header class="mb-8 flex items-center justify-between">
    <div>
        <h1 class="text-3xl font-bold text-neutral-900">Manage Members</h1>
        <p class="text-neutral-600">Add, edit, or remove gym members.</p>
    </div>
    <div>
        <!-- 
          We will wire this up later to show a modal form.
          This is the button from your AdminDashboard.tsx.
        -->
        <a href="{{ url_for('admin_add_member') }}"
            class="bg-primary-600 hover:bg-primary-700 text-white font-medium py-2 px-4 rounded-lg shadow-md transition-colors flex items-center gap-2">
            <!-- Plus Icon -->
            <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="12" x2="12" y1="5" y2="19"></line>
                <line x1="5" x2="19" y1="12" y2="12"></line>
            </svg>
            <span>Add Member</span>
        </a>
    </div>
</header>

<!-- 
  This is the main members table, translated from your AdminDashboard.tsx.
-->
<div class="bg-white rounded-xl shadow-lg border border-neutral-200 overflow-hidden">
    <table class="min-w-full divide-y divide-neutral-200">
        <thead class="bg-neutral-50">
            <tr>
                <th scope="col"
                    class="px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase tracking-wider">Name</th>
                <th scope="col"
                    class="px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase tracking-wider">Contact
                </th>
                <th scope="col"
                    class="px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase tracking-wider">Plan</th>
                <th scope="col"
                    class="px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase tracking-wider">Status
                </th>
                <th scope="col"
                    class="px-6 py-3 text-right text-xs font-medium text-neutral-500 uppercase tracking-wider">Actions
                </th>
            </tr>
        </thead>
        <tbody class="bg-white divide-y divide-neutral-200">
            <!-- 
              This is the JINJA LOOP.
              It loops over the 'members_list' we passed from app.py.
            -->
            {% for member in members_list %}
            <tr>
                <td class="px-6 py-4 whitespace-nowrap">
                    <div class="text-sm font-medium text-neutral-900">{{ member.name }}</div>
                    <div class="text-sm text-neutral-500">Joined: {{ member.joined_date or 'N/A' }}</div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                    <div class="text-sm text-neutral-900">{{ member.email }}</div>
                    <div class="text-sm text-neutral-500">{{ member.phone or 'No phone' }}</div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                    <span
                        class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-primary-100 text-primary-800">
                        {{ member.plan or 'None' }}
                    </span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                    <!-- Logic to change badge color based on status -->
                    {% if member.status == 'Active' %}
                    <span
                        class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                        Active
                    </span>
                    {% elif member.status == 'Expired' %}
                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">
                        Expired
                    </span>
                    {% else %}
                    <span
                        class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-neutral-100 text-neutral-800">
                        {{ member.status or 'Unknown' }}
                    </span>
                    {% endif %}
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                    <!-- These buttons don't do anything yet, but we will wire them up later -->
                    <a href="{{ url_for('admin_edit_member', member_id=member.id) }}" class="text-primary-600 hover:text-primary-900 font-medium">Edit</a>
                    <form action="{{ url_for('admin_delete_member', member_id=member.id) }}" method="POST"
                        class="inline-block ml-4">
                        <button type="submit" class="text-red-600 hover:text-red-900 font-medium"
                            onclick="return confirm('Are you sure you want to delete this member? This action cannot be undone.')">
                            Delete
                        </button>
                    </form>
                </td>
            </tr>
            {% endfor %}

            <!-- This shows if the members_list is empty -->
            {% if not members_list %}
            <tr>
                <td colspan="5" class="px-6 py-12 text-center text-neutral-500">
                    No members found.
                </td>
            </tr>
            {% endif %}

        </tbody>
    </table>
</div>
{% endblock %}